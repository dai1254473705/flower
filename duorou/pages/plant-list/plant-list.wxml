<!--pages/plant-list/plant-list.wxml-->
<view class="container {{currentTheme}}" style="font-size: {{fontSizeValue}}rpx;">
  <!-- 单个植物详情模式 -->
  <block wx:if="{{plantId && currentPlant}}">
    <!-- 植物详情 -->
    <view class="plant-detail-section">
      <image class="plant-detail-image" src="{{currentPlant.src}}" mode="aspectFill"></image>
      <view class="plant-detail-info">
        <text class="plant-detail-title">{{currentPlant.title}}</text>
        <text class="plant-detail-category">{{currentPlant.category || '未分类'}}</text>
        <view class="collection-btn-large" catchtap="toggleCollection" data-plant="{{currentPlant}}">
          <text class="icon {{currentPlant.isCollected ? 'collected' : ''}}">{{currentPlant.isCollected ? '♥' : '♡'}}</text>
          <text>{{currentPlant.isCollected ? '已收藏' : '收藏'}}</text>
        </view>
      </view>
    </view>

    <!-- 文章列表 -->
    <view class="articles-section">
      <view class="section-header">
        <text class="section-title">相关文章</text>
      </view>
      
      <view class="articles-list">
        <block wx:if="{{currentPlant.articles && currentPlant.articles.length > 0}}">
          <view class="article-item" wx:for="{{currentPlant.articles}}" wx:key="index" bindtap="openArticle" data-article="{{item}}">
            <text class="article-title">{{item.title}}</text>
            <text class="article-icon">→</text>
          </view>
        </block>
        <block wx:else>
          <view class="empty">
            <text>暂无相关文章</text>
          </view>
        </block>
      </view>
    </view>
  </block>

  <!-- 植物列表模式 -->
  <block wx:else>
    <!-- 页面标题 -->
    <view class="page-header">
      <text class="page-title">{{category || '植物列表'}}</text>
      <text class="plant-count">共{{plants.length}}种植物</text>
    </view>

    <!-- 植物列表 -->
    <view class="plants-list">
      <!-- 骨架屏 -->
      <block wx:if="{{showSkeleton}}">
        <view class="plant-item" wx:for="{{skeletonCount}}" wx:key="index">
          <view class="skeleton skeleton-image"></view>
          <view class="plant-info">
            <view class="skeleton skeleton-title"></view>
            <view class="skeleton skeleton-category"></view>
          </view>
          <view class="collection-btn">
            <text class="icon">♡</text>
          </view>
        </view>
      </block>
      
      <!-- 真实数据 -->
      <block wx:elif="{{!showSkeleton && plants.length > 0}}">
        <view class="plant-item" wx:for="{{plants}}" wx:key="id" bindtap="goToPlantDetail" data-plant="{{item}}">
          <image class="plant-image" src="{{item.src}}" mode="aspectFill" lazy-load="true"></image>
          <view class="plant-info">
            <text class="plant-title">{{item.title}}</text>
            <text class="plant-category">{{item.category}}</text>
          </view>
          <view class="collection-btn" catchtap="toggleCollection" data-plant="{{item}}">
            <text class="icon {{item.isCollected ? 'collected' : ''}}">{{item.isCollected ? '♥' : '♡'}}</text>
          </view>
        </view>
      </block>
    </view>

    <!-- 加载状态 -->
    <view wx:if="{{loading}}" class="loading">
      <text>加载中...</text>
    </view>

    <view wx:if="{{!loading && plants.length === 0}}" class="empty">
      <text>该分类下暂无植物</text>
    </view>

    <view wx:if="{{showNoMore && plants.length > 0}}" class="no-more">
      <text>没有更多数据了</text>
    </view>
  </block>
</view>