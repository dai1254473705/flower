<!--pages/index/index.wxml-->
<view class="container {{currentTheme}}" style="font-size: {{fontSizeValue}}rpx;">
  <!-- 轮播图 -->
  <view class="banner-section">
    <swiper class="banner-swiper" indicator-dots circular autoplay interval="3000">
      <swiper-item wx:for="{{banners}}" wx:key="id">
        <image src="{{item.image || item.src}}" mode="aspectFill" class="banner-image"></image>
        <view class="banner-mask"></view>
        <view class="banner-title">{{item.title || ''}}</view>
      </swiper-item>
    </swiper>
  </view>

  <!-- 搜索栏 -->
  <view class="search-section">
    <view class="search-bar">
      <input 
        class="search-input" 
        placeholder="搜索多肉植物名称" 
        value="{{searchValue}}"
        bindinput="onSearchInput"
        bindconfirm="onSearch"
      />
      <button class="search-btn" bindtap="onSearch">搜索</button>
    </view>
    <view class="action-buttons">
      <view class="category-btn" bindtap="goToCategory">
        <text>分类浏览</text>
        <text class="icon">›</text>
      </view>
      <view class="settings-btn" bindtap="goToSettings">
        <text class="icon">⚙️</text>
        <text>设置</text>
      </view>
    </view>
  </view>

  <!-- 植物网格展示 -->
  <view class="plants-grid">
    <!-- 骨架屏 -->
    <block wx:if="{{showSkeleton}}" wx:for="{{skeletonCount}}" wx:key="index">
      <view class="plant-card skeleton-card">
        <view class="skeleton skeleton-image"></view>
        <view class="plant-info">
          <view class="skeleton skeleton-title"></view>
          <view class="skeleton skeleton-category"></view>
        </view>
      </view>
    </block>
    
    <!-- 真实数据 -->
    <block wx:if="{{!showSkeleton && plants.length > 0}}" wx:for="{{plants}}" wx:key="id">
      <view class="plant-card" bindtap="goToPlantList" data-plant="{{item}}">
        <image class="plant-image" src="{{item.src}}" mode="aspectFill" lazy-load="true"></image>
        <view class="plant-info">
          <text class="plant-title">{{item.title}}</text>
          <text class="plant-category">{{item.category}}</text>
        </view>
        <view class="collection-btn" catchtap="toggleCollection" data-plant="{{item}}">
          <text class="icon {{item.isCollected ? 'collected' : ''}}">{{item.isCollected ? '♥' : '♡'}}</text>
        </view>
      </view>
    </block>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>

  <view wx:if="{{!loading && plants.length === 0}}" class="empty">
    <text>暂无数据</text>
  </view>

  <view wx:if="{{showNoMore && plants.length > 0}}" class="no-more">
    <text>没有更多数据了</text>
  </view>
</view>